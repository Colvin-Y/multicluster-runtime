# Release Process

This repository includes serveral Go modules: The "main" Go module `sigs.k8s.io/multicluster-runtime` and several provider modules.

The release process is partially automated. The following steps need to be taken:

1. Create a new branch, e.g. `prepare-0.24.0-alpha.7` from `main` (or the respective release branch).
2. Run `./hack/release-commit.sh <version>` (e.g. `./hack/release-commit.sh v0.24.0-alpha.7`).
3. Push the resulting branch and open a PR to get it merged into `main` (or the respective release branch).
4. Once merged, follow the instructions in the output of `./hack/release-commit.sh` and push the release tags.

This release process makes sure that _all_ tags for a release are on the same commit (the commit generated by the script).

## `release-commit.sh`

Behaviour of this script can be adjusted with the following environment variables:

- `GIT_TAG_OPTIONS`: Optional flags to be passed to `git tag`. Example: `GIT_TAG_OPTIONS=-s` to sign git tags with your GPG key.
- `GIT_COMMIT_OPTIONS`: Optional flags to be passed to `git commit`. Example: `GIT_COMMIT_OPTIONS=-s -S` to sign-off on your commits and sign them with your GPG key.
- `GIT_COMMIT_PUSH` and `GIT_COMMIT_REMOTE`: To push the release commit automatically. Need to be both set. Example: `GIT_COMMIT_PUSH=1 GIT_COMMIT_REMOTE=fork`.

## Versioning

`sigs.k8s.io/multicluster-runtime` follows the `sigs.k8s.io/controller-runtime` version for ease of use (e.g. the version of multicluster-runtime that depends on controller-runtime `v0.20.4` must also be `v0.20.4`). Make sure that [go.mod](../../go.mod) contains the right dependency before tagging a new release.
